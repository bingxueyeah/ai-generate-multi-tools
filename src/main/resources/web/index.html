<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTMLå·¥å…·ç”Ÿæˆå™¨</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            padding: 20px; 
        }
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 20px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); 
            overflow: hidden; 
            display: flex; 
            min-height: calc(100vh - 40px); 
        }
        .header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 30px; 
            text-align: center; 
            width: 100%; 
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        .content-wrapper { 
            display: flex; 
            width: 100%; 
            height: calc(100vh - 180px); 
        }
        .left-panel { 
            width: 40%; 
            padding: 30px; 
            border-right: 2px solid #e0e0e0; 
            display: flex; 
            flex-direction: column; 
            background: #f9f9f9; 
        }
        .right-panel { 
            width: 60%; 
            padding: 30px; 
            display: flex; 
            flex-direction: column; 
            background: white; 
            overflow-y: auto; 
        }
        .input-group { margin-bottom: 20px; }
        label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 600; 
            color: #333; 
            font-size: 1.1em; 
        }
        textarea { 
            width: 100%; 
            padding: 15px; 
            border: 2px solid #e0e0e0; 
            border-radius: 10px; 
            font-size: 14px; 
            font-family: inherit; 
            min-height: 300px; 
            resize: vertical; 
            transition: border-color 0.3s; 
        }
        textarea:focus { 
            outline: none; 
            border-color: #667eea; 
        }
        button { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            border: none; 
            padding: 15px 40px; 
            border-radius: 10px; 
            font-size: 16px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: transform 0.2s, box-shadow 0.2s; 
            width: 100%; 
        }
        button:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); 
        }
        button:active { transform: translateY(0); }
        button:disabled { 
            opacity: 0.6; 
            cursor: not-allowed; 
            transform: none; 
        }
        .preview-area { 
            flex: 1; 
            border: 2px dashed #e0e0e0; 
            border-radius: 10px; 
            padding: 20px; 
            background: #fafafa; 
            min-height: 400px; 
            overflow-y: auto; 
        }
        .preview-placeholder { 
            text-align: center; 
            color: #999; 
            padding: 50px; 
            font-size: 1.1em; 
        }
        .file-info { 
            background: #f0f4ff; 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 15px; 
        }
        .file-info h3 { 
            color: #667eea; 
            margin-bottom: 10px; 
        }
        .file-info p { 
            color: #666; 
            margin: 5px 0; 
        }
        .download-btn { 
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); 
            margin-top: 10px; 
        }
        .loading { 
            text-align: center; 
            padding: 50px; 
            color: #667eea; 
        }
        .error { 
            background: #fee; 
            color: #c33; 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 15px; 
        }
        .success { 
            background: #efe; 
            color: #3c3; 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 15px; 
        }
        iframe { 
            width: 100%; 
            height: 100%; 
            border: none; 
            border-radius: 8px; 
        }
        .examples { 
            margin-top: 20px; 
            padding: 15px; 
            background: #f0f4ff; 
            border-radius: 8px; 
        }
        .examples h4 { 
            color: #667eea; 
            margin-bottom: 10px; 
        }
        .example-item { 
            padding: 8px; 
            margin: 5px 0; 
            background: white; 
            border-radius: 5px; 
            cursor: pointer; 
            transition: background 0.2s; 
        }
        .example-item:hover { 
            background: #e0e8ff; 
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="width: 100%; display: flex; flex-direction: column;">
            <div class="header">
                <h1>ğŸ› ï¸ HTMLå·¥å…·ç”Ÿæˆå™¨</h1>
                <p>æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œè‡ªåŠ¨ç”Ÿæˆå¯ç”¨çš„HTMLå°å·¥å…·</p>
            </div>
            <div class="content-wrapper">
                <div class="left-panel">
                    <div class="input-group">
                        <label for="userInput">è¯·è¾“å…¥æ‚¨çš„éœ€æ±‚ï¼š</label>
                        <textarea id="userInput" placeholder="ä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè®¡ç®—å™¨å·¥å…·"></textarea>
                    </div>
                    <button id="generateBtn" onclick="generateTool()">ç”Ÿæˆå·¥å…·</button>
                    <div class="examples">
                        <h4>ğŸ’¡ ç¤ºä¾‹éœ€æ±‚ï¼š</h4>
                        <div class="example-item" onclick="setExample('ç”Ÿæˆä¸€ä¸ªè®¡ç®—å™¨å·¥å…·')">ç”Ÿæˆä¸€ä¸ªè®¡ç®—å™¨å·¥å…·</div>
                        <div class="example-item" onclick="setExample('ç”Ÿæˆä¸€ä¸ªè¡¨æ ¼ç”Ÿæˆå™¨')">ç”Ÿæˆä¸€ä¸ªè¡¨æ ¼ç”Ÿæˆå™¨</div>
                        <div class="example-item" onclick="setExample('ç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å·¥å…·')">ç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å·¥å…·</div>
                        <div class="example-item" onclick="setExample('ç”Ÿæˆä¸€ä¸ªJSONæ ¼å¼åŒ–å·¥å…·')">ç”Ÿæˆä¸€ä¸ªJSONæ ¼å¼åŒ–å·¥å…·</div>
                        <div class="example-item" onclick="setExample('ç”Ÿæˆä¸€ä¸ªæ•°æ®è½¬æ¢å·¥å…·')">ç”Ÿæˆä¸€ä¸ªæ•°æ®è½¬æ¢å·¥å…·</div>
                    </div>
                </div>
                <div class="right-panel">
                    <div id="previewArea" class="preview-area">
                        <div class="preview-placeholder">
                            <p>ğŸ‘ˆ è¯·åœ¨å·¦ä¾§è¾“å…¥æ‚¨çš„éœ€æ±‚</p>
                            <p>ç”Ÿæˆçš„å·¥å…·å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // é¡µé¢åŠ è½½æ—¶è®¾ç½®é»˜è®¤æ–‡æœ¬
        document.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('userInput');
            // å¦‚æœtextareaä¸ºç©ºï¼Œè®¾ç½®é»˜è®¤æ–‡æœ¬ï¼ˆæ”¯æŒæ¢è¡Œï¼‰
            if (!textarea.value.trim()) {
                textarea.value = 'ä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè®¡ç®—å™¨å·¥å…·\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè¡¨æ ¼ç”Ÿæˆå™¨\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å·¥å…·';
                // æ·»åŠ æ ·å¼ä½¿é»˜è®¤æ–‡æœ¬çœ‹èµ·æ¥åƒplaceholder
                textarea.style.color = '#999';
                // å½“ç”¨æˆ·å¼€å§‹è¾“å…¥æ—¶ï¼Œæ¸…é™¤é»˜è®¤æ–‡æœ¬
                textarea.addEventListener('focus', function() {
                    if (this.value === 'ä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè®¡ç®—å™¨å·¥å…·\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè¡¨æ ¼ç”Ÿæˆå™¨\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å·¥å…·') {
                        this.value = '';
                        this.style.color = '#333';
                    }
                });
                // å½“å¤±å»ç„¦ç‚¹ä¸”ä¸ºç©ºæ—¶ï¼Œæ¢å¤é»˜è®¤æ–‡æœ¬
                textarea.addEventListener('blur', function() {
                    if (!this.value.trim()) {
                        this.value = 'ä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè®¡ç®—å™¨å·¥å…·\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè¡¨æ ¼ç”Ÿæˆå™¨\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å·¥å…·';
                        this.style.color = '#999';
                    }
                });
            }
        });
        
        function setExample(text) {
            const textarea = document.getElementById('userInput');
            textarea.value = text;
            textarea.style.color = '#333';
        }
        
        async function generateTool() {
            let userInput = document.getElementById('userInput').value.trim();
            // å¦‚æœè¾“å…¥çš„æ˜¯é»˜è®¤æ–‡æœ¬ï¼Œè§†ä¸ºç©ºè¾“å…¥
            if (!userInput || userInput === 'ä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè®¡ç®—å™¨å·¥å…·\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªè¡¨æ ¼ç”Ÿæˆå™¨\nä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å·¥å…·') {
                alert('è¯·è¾“å…¥æ‚¨çš„éœ€æ±‚ï¼');
                return;
            }
            
            const generateBtn = document.getElementById('generateBtn');
            const previewArea = document.getElementById('previewArea');
            
            // ç¦ç”¨æŒ‰é’®ï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€
            generateBtn.disabled = true;
            generateBtn.textContent = 'ç”Ÿæˆä¸­...';
            previewArea.innerHTML = '<div class="loading">ğŸ¤– æ­£åœ¨ç”Ÿæˆå·¥å…·ï¼Œè¯·ç¨å€™...</div>';
            
            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ request: userInput })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
                    let html = '<div class="success">âœ“ å·¥å…·ç”ŸæˆæˆåŠŸï¼</div>';
                    html += '<div class="file-info">';
                    html += '<h3>ğŸ“„ ç”Ÿæˆçš„æ–‡ä»¶</h3>';
                    html += '<p><strong>æ–‡ä»¶åï¼š</strong>' + escapeHtml(data.filename) + '</p>';
                    html += '<p><strong>ä¿å­˜è·¯å¾„ï¼š</strong>' + escapeHtml(data.filepath) + '</p>';
                    html += '<button class="download-btn" onclick="downloadFile(\'' + data.filename + '\')">â¬‡ï¸ ä¸‹è½½æ–‡ä»¶</button>';
                    html += '</div>';
                    html += '<div style="height: 600px; border: 2px solid #e0e0e0; border-radius: 8px; overflow: hidden;">';
                    html += '<iframe srcdoc="' + escapeHtml(data.htmlContent) + '"></iframe>';
                    html += '</div>';
                    
                    previewArea.innerHTML = html;
                } else {
                    previewArea.innerHTML = '<div class="error">âœ— ç”Ÿæˆå¤±è´¥ï¼š' + escapeHtml(data.error) + '</div>';
                }
            } catch (error) {
                previewArea.innerHTML = '<div class="error">âœ— è¯·æ±‚å¤±è´¥ï¼š' + escapeHtml(error.message) + '</div>';
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'ç”Ÿæˆå·¥å…·';
            }
        }
        
        function downloadFile(filename) {
            window.location.href = '/api/download?file=' + encodeURIComponent(filename);
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML.replace(/"/g, '&quot;').replace(/'/g, '&#39;');
        }
    </script>
</body>
</html>
